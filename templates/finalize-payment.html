{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Finalize Payment - ResearchSupportDesk</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-50">
  {% if messages %}
    <div class="container mx-auto px-4 py-4">
      {% for message in messages %}
        <div class="bg-{{ message.tags }}-100 border border-{{ message.tags }}-200 text-{{ message.tags }}-800 p-4 rounded-md mb-4">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Navigation -->
  <nav class="bg-white shadow-sm border-b">
    <div class="container mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="text-2xl font-bold text-gray-900">
          RESEARCH<span class="text-blue-600">SupportDesk</span>
        </div>
        <div class="text-sm text-gray-600">Finalize Payment</div>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <section class="py-12 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
          Complete Your Research Service Payment
        </h1>
        <p class="text-lg text-gray-600">
          Follow the steps below to finalize your research service agreement and begin your project.
        </p>
      </div>
    </div>
  </section>

  <!-- Progress Steps -->
  <section class="py-8">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="flex items-center justify-center space-x-8">
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full flex items-center justify-center {% if current_step >= 1 %}bg-blue-600 text-white{% else %}bg-gray-200 text-gray-500{% endif %}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
            </div>
            <span class="ml-2 text-sm font-medium {% if current_step >= 1 %}text-blue-600{% else %}text-gray-500{% endif %}">
              Review Services
            </span>
            <div class="w-8 h-0.5 bg-gray-300 rounded mx-4"></div>
          </div>
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full flex items-center justify-center {% if current_step >= 2 %}bg-blue-600 text-white{% else %}bg-gray-200 text-gray-500{% endif %}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
              </svg>
            </div>
            <span class="ml-2 text-sm font-medium {% if current_step >= 2 %}text-blue-600{% else %}text-gray-500{% endif %}">
              Make Payment
            </span>
            <div class="w-8 h-0.5 bg-gray-300 rounded mx-4"></div>
          </div>
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full flex items-center justify-center {% if current_step >= 3 %}bg-blue-600 text-white{% else %}bg-gray-200 text-gray-500{% endif %}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
              </svg>
            </div>
            <span class="ml-2 text-sm font-medium {% if current_step >= 3 %}text-blue-600{% else %}text-gray-500{% endif %}">
              Upload Proof
            </span>
            <div class="w-8 h-0.5 bg-gray-300 rounded mx-4"></div>
          </div>
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full flex items-center justify-center {% if current_step >= 4 %}bg-blue-600 text-white{% else %}bg-gray-200 text-gray-500{% endif %}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <span class="ml-2 text-sm font-medium {% if current_step >= 4 %}text-blue-600{% else %}text-gray-500{% endif %}">
              Confirmation
            </span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="py-12">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <!-- Step 1: Review Services -->
        {% if current_step == 1 %}
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Review Your Selected Services</h2>

            <!-- Instructions -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
              <h3 class="font-bold text-blue-800 mb-3">Instructions:</h3>
              <ul class="text-blue-700 space-y-2">
                <li>• Review your agreed service items and their prices</li>
                <li>• Make payment via the preferred method (account details will be provided)</li>
                <li>• Upload proof of payment and provide your contact details</li>
                <li>• A consultant will reach out to you to confirm receipt within 24 hours</li>
              </ul>
            </div>

            <!-- Services List -->
            <div class="space-y-4 mb-8">
              {% for service in selected_services %}
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                  <div class="flex items-center space-x-3">
                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <span class="font-medium text-gray-900">{{ service.title }}</span>
                  </div>
                  <span class="font-bold text-blue-600">₦{{ service.price|floatformat:0 }}</span>
                </div>
              {% endfor %}
            </div>

            <!-- Total -->
            <div class="border-t border-gray-200 pt-6 mb-8">
              <div class="flex justify-between items-center text-xl font-bold">
                <span class="text-gray-900">Total Amount:</span>
                <span class="text-blue-600">₦{{ total_amount|floatformat:0 }}</span>
              </div>
            </div>

            <!-- Continue Button -->
            <a href="{% url 'core:finalize_payment' %}?step=2" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 px-6 rounded-md font-medium text-lg transition-colors text-center block">
              Make Payment Now
            </a>
          </div>
        {% endif %}

        <!-- Step 2: Payment Instructions -->
        {% if current_step == 2 %}
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Payment Instructions</h2>

            <!-- Payment Amount -->
            <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-8 text-center">
              <h3 class="text-lg font-bold text-green-800 mb-2">Amount to Pay</h3>
              <div class="text-3xl font-bold text-green-600">₦{{ total_amount|floatformat:0 }}</div>
            </div>

            <!-- Bank Details -->
            <div class="bg-gray-50 rounded-lg p-6 mb-8">
              <h3 class="text-lg font-bold text-gray-900 mb-4">Bank Transfer Details</h3>
              <div class="grid md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-600 mb-1">Bank Name</label>
                  <div class="flex items-center justify-between bg-white p-3 rounded border">
                    <span class="font-medium">{{ bank_details.bankName }}</span>
                    <button onclick="copyToClipboard('{{ bank_details.bankName|escapejs }}')" class="text-blue-600 hover:text-blue-700">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-600 mb-1">Account Name</label>
                  <div class="flex items-center justify-between bg-white p-3 rounded border">
                    <span class="font-medium">{{ bank_details.accountName }}</span>
                    <button onclick="copyToClipboard('{{ bank_details.accountName|escapejs }}')" class="text-blue-600 hover:text-blue-700">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-600 mb-1">Account Number</label>
                  <div class="flex items-center justify-between bg-white p-3 rounded border">
                    <span class="font-medium text-lg">{{ bank_details.accountNumber }}</span>
                    <button onclick="copyToClipboard('{{ bank_details.accountNumber|escapejs }}')" class="text-blue-600 hover:text-blue-700">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-600 mb-1">Sort Code</label>
                  <div class="flex items-center justify-between bg-white p-3 rounded border">
                    <span class="font-medium">{{ bank_details.sortCode }}</span>
                    <button onclick="copyToClipboard('{{ bank_details.sortCode|escapejs }}')" class="text-blue-600 hover:text-blue-700">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Important Notes -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8">
              <div class="flex items-start space-x-3">
                <svg class="w-5 h-5 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div>
                  <h4 class="font-bold text-yellow-800 mb-2">Important Notes:</h4>
                  <ul class="text-yellow-700 space-y-1 text-sm">
                    <li>• Use your full name as the transfer reference</li>
                    <li>• Keep your payment receipt/screenshot for upload</li>
                    <li>• Payment confirmation may take 1-2 business days</li>
                    <li>• Contact us immediately if you encounter any issues</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Continue Button -->
            <a href="{% url 'core:finalize_payment' %}?step=3" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 px-6 rounded-md font-medium text-lg transition-colors text-center block">
              I Have Made Payment - Upload Proof
            </a>
          </div>
        {% endif %}

        <!-- Step 3: Upload Proof & Contact Details -->
        {% if current_step == 3 %}
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Upload Payment Proof & Contact Details</h2>

            <form id="payment-form" action="{% url 'core:finalize_payment_submit' %}" method="POST" enctype="multipart/form-data" class="space-y-6">
              {% csrf_token %}
              <!-- Payment Proof Upload -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Payment Proof (Receipt/Screenshot) *
                </label>
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                  <input
                    type="file"
                    accept="image/*,.pdf"
                    name="paymentProof"
                    id="paymentProof"
                    class="hidden"
                    required
                  />
                  <label for="paymentProof" class="cursor-pointer">
                    <svg class="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24  Worksheet: HTML & Tailwind CSS
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                  </svg>
                  <p id="file-name" class="text-gray-600 mb-2">Click to upload payment proof</p>
                  <p class="text-sm text-gray-500">Supports: JPG, PNG, PDF (Max 5MB)</p>
                </label>
              </div>
            </div>

            <!-- Contact Details -->
            <div class="grid md:grid-cols-2 gap-6">
              <div>
                <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">
                  <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                  Full Name *
                </label>
                <input
                  type="text"
                  id="fullName"
                  name="fullName"
                  value="{{ consultation_data.fullName|default:'' }}"
                  class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  required
                />
              </div>
              <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                  <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l9-6 9 6v10a2 2 0 01-2 2H5a2 2 0 01-2-2V8z"></path>
                  </svg>
                  Email Address *
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  value="{{ consultation_data.email|default:'' }}"
                  class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  required
                />
              </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
              <div>
                <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-2">
                  <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                  </svg>
                  Phone Number *
                </label>
                <input
                  type="tel"
                  id="phoneNumber"
                  name="phoneNumber"
                  value="{{ consultation_data.phoneNumber|default:'' }}"
                  class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  required
                />
              </div>
              <div>
                <label for="institution" class="block text-sm font-medium text-gray-700 mb-2">
                  <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                  </svg>
                  Institution *
                </label>
                <input
                  type="text"
                  id="institution"
                  name="institution"
                  value="{{ consultation_data.institution|default:'' }}"
                  class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                  required
                />
              </div>
            </div>

            <!-- Additional Notes -->
            <div>
              <label for="additionalNotes" class="block text-sm font-medium text-gray-700 mb-2">
                Additional Notes (Optional)
              </label>
              <textarea
                id="additionalNotes"
                name="additionalNotes"
                rows="4"
                class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder="Any additional information or special requests..."
              ></textarea>
            </div>

            <!-- Submit Button -->
            <button
              type="submit"
              id="submit-btn"
              class="w-full py-4 px-6 rounded-md font-medium text-lg transition-colors bg-gray-300 text-gray-500 cursor-not-allowed"
              disabled
            >
              Submit Payment Proof
            </button>
          </form>
        </div>
        {% endif %}

        <!-- Step 4: Success Message -->
        {% if current_step == 4 %}
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center">
            <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <svg class="w-12 h-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>

            <h2 class="text-2xl font-bold text-gray-900 mb-4">Payment Proof Submitted Successfully!</h2>

            <div class="bg-green-50 border border-green-200 rounded-lg p-6 mb-8">
              <p class="text-green-800 text-lg">
                ✅ Thank you! Your payment proof has been submitted. A consultant will verify and contact you within 24 hours.
              </p>
            </div>

            <div class="space-y-4 text-left max-w-md mx-auto">
              <h3 class="font-bold text-gray-900">What happens next:</h3>
              <ul class="text-gray-600 space-y-2">
                <li>• Our team will verify your payment within 24 hours</li>
                <li>• A dedicated consultant will be assigned to your project</li>
                <li>• You'll receive a project timeline and next steps</li>
                <li>• Work on your research services will begin immediately</li>
              </ul>
            </div>

            <div class="flex flex-col sm:flex-row gap-4 justify-center mt-8">
              <a href="{% url 'core:home' %}" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-md font-medium transition-colors">
                Return to Home
              </a>
              <a href="{% url 'core:contact' %}" class="border border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white px-8 py-3 rounded-md font-medium transition-colors">
                Contact Support
              </a>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-8">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-lg font-bold mb-4">ResearchSupportDesk</h3>
          <p class="text-gray-400">
            Empowering students and researchers with expert guidance and innovative solutions.
          </p>
        </div>
        <div>
          <h3 class="text-lg font-bold mb-4">Quick Links</h3>
          <ul class="space-y-2">
            <li><a href="{% url 'core:home' %}" class="text-gray-400 hover:text-white">Home</a></li>
            <li><a href="{% url 'core:about' %}" class="text-gray-400 hover:text-white">About</a></li>
            <li><a href="{% url 'core:services' %}" class="text-gray-400 hover:text-white">Services</a></li>
            <li><a href="{% url 'core:contact' %}" class="text-gray-400 hover:text-white">Contact</a></li>
          </ul>
        </div>
        <div>
          <h3 class="text-lg font-bold mb-4">Contact Us</h3>
          <p class="text-gray-400">Email: <a href="mailto:info@researchsupportdesk.com" class="hover:text-white">info@researchsupportdesk.com</a></p>
          <p class="text-gray-400">Phone: <a href="tel:+2348123456789" class="hover:text-white">+234 812 345 6789</a></p>
        </div>
        <div>
          <h3 class="text-lg font-bold mb-4">Follow Us</h3>
          <p class="text-gray-400">Stay updated on social media.</p>
        </div>
      </div>
      <div class="mt-8 text-center text-gray-400">
        © 2025 ResearchSupportDesk. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert('Copied to clipboard!');
      });
    }

    const form = document.getElementById('payment-form');
    const submitBtn = document.getElementById('submit-btn');
    const fileInput = document.getElementById('paymentProof');
    const fileName = document.getElementById('file-name');
    const inputs = form ? form.querySelectorAll('input[required], textarea') : [];

    function validateForm() {
      let isValid = true;
      inputs.forEach(input => {
        if (input.type !== 'file' && !input.value.trim()) isValid = false;
      });
      if (!fileInput.files.length) isValid = false;

      if (isValid) {
        submitBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
        submitBtn.classList.add('bg-blue-600', 'text-white', 'hover:bg-blue-700');
        submitBtn.disabled = false;
      } else {
        submitBtn.classList.remove('bg-blue-600', 'text-white', 'hover:bg-blue-700');
        submitBtn.classList.add('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
        submitBtn.disabled = true;
      }
    }

    if (fileInput) {
      fileInput.addEventListener('change', () => {
        const file = fileInput.files[0];
        if (file) {
          const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];
          const maxSize = 5 * 1024 * 1024; // 5MB
          if (!allowedTypes.includes(file.type)) {
            alert('Please upload a valid image (JPG, PNG) or PDF file');
            fileInput.value = '';
            fileName.textContent = 'Click to upload payment proof';
            validateForm();
            return;
          }
          if (file.size > maxSize) {
            alert('File size must be less than 5MB');
            fileInput.value = '';
            fileName.textContent = 'Click to upload payment proof';
            validateForm();
            return;
          }
          fileName.textContent = file.name;
        } else {
          fileName.textContent = 'Click to upload payment proof';
        }
        validateForm();
      });
    }

    inputs.forEach(input => {
      input.addEventListener('input', validateForm);
      input.addEventListener('change', validateForm);
    });

    if (form) {
      form.addEventListener('submit', () => {
        submitBtn.disabled = true;
        submitBtn.innerHTML = `
          <div class="flex items-center justify-center space-x-2">
            <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
            <span>Submitting...</span>
          </div>
        `;
      });
    }

    // Initial validation
    if (form) validateForm();
  </script>
</body>
</html>